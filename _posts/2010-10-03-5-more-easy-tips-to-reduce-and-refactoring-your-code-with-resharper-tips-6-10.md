---
layout: post
title: 5 (more) Easy Tips to Reduce and Refactor your Code with Resharper (Tips 6-10)
date: 2010-10-03 19:26
author: John
comments: true
categories: [Silverlight]
---
<p>This weekend <a href="/silverlight/5-easy-tips-to-reduce-and-refactor-your-code-with-resharper/">I posted 5 simple ways to reduce your code using Resharper (tips 1-5)</a>. I decided to follow that up with another set of 5 quick and easy tips, so here they go. Hopefully these tips will show you some things I do to turn on&#160; (and off) some refactoring suggestions.</p>  <h3><font style="font-weight: bold">Tip 6) Remove Parameter, and Update Usages</font></h3>  <p>I had a method in an interface where at one point I was using 3 parameters. Somewhere along the way I stopped using one of the parameters, and <a href="http://www.jetbrains.com/resharper/">Resharper</a> was kind enough to point this out tome. It can easily remove the parameter and update all usages so all classes that implement the interface are updated. To find the suggestion you can either run the Find Code Issues feature or go to the file and press F12. Then</p>  <ul>   <li>ALT + ENTER </li>    <li>ENTER </li> </ul>  <p>So this</p>  <p><a href="/wp-content/uploads/files/media/image/Windows-Live-Writer/46b0f1ac47cd_DCF5/image_2.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/Windows-Live-Writer/46b0f1ac47cd_DCF5/image_thumb.png" width="523" height="116" /></a></p>  <p>becomes this</p>  <p><a href="/wp-content/uploads/files/media/image/Windows-Live-Writer/46b0f1ac47cd_DCF5/image_4.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/Windows-Live-Writer/46b0f1ac47cd_DCF5/image_thumb_1.png" width="522" height="23" /></a></p>  <h3><font style="font-weight: bold">Tip 7) Use the ?? Operator Instead of If/Then for Null checks</font></h3>  <p>Anytime you want to grab an object or collection and you may get it from multiple places, you might be creating if/then logic to handle this. You can actually use the ?? operator which shortens the code and is just as readable (more so to me). The ?? operator executes the left most expression and returns it if it is not null. I t continues executing the expressions to the right only if the previous ones were null. So you can take code like this:</p>  <ul><!--EndFragment--></ul>  <p><a href="/wp-content/uploads/files/media/image/Windows-Live-Writer/46b0f1ac47cd_DCF5/image_6.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/Windows-Live-Writer/46b0f1ac47cd_DCF5/image_thumb_2.png" width="526" height="106" /></a></p>  <p>press </p>  <ul>   <li>ALT + ENTER </li>    <li>ENTER </li> </ul>  <p>and it becomes this</p>  <p><a href="/wp-content/uploads/files/media/image/Windows-Live-Writer/46b0f1ac47cd_DCF5/image_8.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/Windows-Live-Writer/46b0f1ac47cd_DCF5/image_thumb_3.png" width="527" height="43" /></a></p>  <h3><font style="font-weight: bold">Tip 8) Ignore Some Suggestions</font></h3>  <p>You may not agree with some of my tips nor Resharper’s tips and that’s totally your call. I tell Resharper to stop suggesting some tips since I don’t want to follow them. For example, I don’t like how it keeps telling me to make classes static or sealed. If I wanted them to be static I would have done so in the first place <img style="border-bottom-style: none; border-right-style: none; border-top-style: none; border-left-style: none" class="wlEmoticon wlEmoticon-smile" alt="Smile" src="/wp-content/uploads/files/media/image/Windows-Live-Writer/46b0f1ac47cd_DCF5/wlEmoticon-smile_2.png" /></p>  <p>I highly recommend you customize Resharper to ignore some of the tips so you spend less time being alerted to things you don’t care about.</p>  <p>Here is how you can tell Resharper to ignore such a situation. Here it tells me my class can be sealed. So I click the “Inspection options …” choice.</p>  <p><a href="/wp-content/uploads/files/media/image/Windows-Live-Writer/46b0f1ac47cd_DCF5/image_12.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/Windows-Live-Writer/46b0f1ac47cd_DCF5/image_thumb_5.png" width="497" height="107" /></a></p>  <p>I am then presented with this dialog and I choose “Do not show” then click OK.</p>  <p><a href="/wp-content/uploads/files/media/image/Windows-Live-Writer/46b0f1ac47cd_DCF5/SNAGHTMLa1bea0.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SNAGHTMLa1bea0" border="0" alt="SNAGHTMLa1bea0" src="/wp-content/uploads/files/media/image/Windows-Live-Writer/46b0f1ac47cd_DCF5/SNAGHTMLa1bea0_thumb.png" width="315" height="223" /></a></p>  <p>Now it won’t bother me anymore with this suggestion. You can also tell lower or raise the severity of the inspection option, here.</p>  <h3><font style="font-weight: bold">Tip 9) Use var When the type is Obvious</font></h3>  <p>This is sure to be one of the most controversial refactoring options I mention. I like using the var keyword when it is really obvious what the type is. I do this in several cases where it is obvious such as initializing an integer or if the type is on the right hand side of the expression. Resharper helps with this (which you can turn off using the previous tip).</p>  <p>So here we have a Dictionary&lt;string, string&gt; which is repeated on both sides. Seriously, do I need to see that? Not me. So a quick </p>  <ul>   <li>ALT + ENTER </li>    <li>ENTER </li> </ul>  <p><a href="/wp-content/uploads/files/media/image/Windows-Live-Writer/46b0f1ac47cd_DCF5/image_14.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/Windows-Live-Writer/46b0f1ac47cd_DCF5/image_thumb_6.png" width="528" height="74" /></a></p>  <p>becomes</p>  <p><a href="/wp-content/uploads/files/media/image/Windows-Live-Writer/46b0f1ac47cd_DCF5/image_16.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/Windows-Live-Writer/46b0f1ac47cd_DCF5/image_thumb_7.png" width="511" height="31" /></a></p>  <p>I find this much more readable. </p>  <p>So where would I not use var? If its not more readable and not obvious what the type is, such as when you can a method that does not make it obvious what is being returned, then do it.</p>  <blockquote>   <p>var foo = GetSomeValue();</p> </blockquote>  <h3><font style="font-weight: bold">Tip 10) Removing Redundant Event Handler Type Declarations</font></h3>  <p>I get blurry eyed seeing all that code that gets created when we generate event handlers. Don’t get me wrong, I absolutely love how we can type +=&#160; then TAB +TAB&#160; and the event handler declaration (and the event handler) are creat
ed. Nobody wants to memorize that syntax. But I don’t need to see the extra code. What am I talking about? Here is what is created when I type </p>  <ul>   <li>Loaded += </li>    <li>TAB </li>    <li>TAB </li> </ul>  <p><a href="/wp-content/uploads/files/media/image/Windows-Live-Writer/46b0f1ac47cd_DCF5/image_18.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/Windows-Live-Writer/46b0f1ac47cd_DCF5/image_thumb_8.png" width="488" height="133" /></a></p>  <p>Very cool that I don’t have to type that. But, I don’t need the “new System.Windows.RoutedEventHandler” to be explicit since the event handler method already defines it to be the correct type. So if I put my cursor on that code (or hit F12) I can type </p>  <ul>   <li>ALT + ENTER </li>    <li>ENTER </li> </ul>  <p>and the event handler assignment becomes this</p>  <p><a href="/wp-content/uploads/files/media/image/Windows-Live-Writer/46b0f1ac47cd_DCF5/image_20.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/Windows-Live-Writer/46b0f1ac47cd_DCF5/image_thumb_9.png" width="465" height="52" /></a></p>  <p>Much cleaner and much more readable, in my opinion.</p>  <p>Of course, all of these tips are my preferences. Use or ignore as you see fit.</p>  <blockquote>   <p>You can do these one at a time or you can set all of these rule sup using the “Find Code Issues” feature of Resharper. Before I run any solution wide code changes I like to first understand what I am changing and customize it. </p></blockquote>

