<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>How to use npm global without sudo on OSX</title>
    
    <meta name="author" content="John Papa">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

    <!-- Le styles -->
    <link href="/assets/resources/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/resources/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <link href="/assets/resources/syntax/syntax.css" rel="stylesheet">
    <link href="/assets/css/style.css" rel="stylesheet">

    <link rel="shortcut icon" type="image/x-icon" href="assets/ico/favicon.ico">

    <!-- Le fav and touch icons -->
    <!-- Update these with your own images
	<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
	-->

    <link rel="alternate" type="application/rss+xml" title="" href="/feed.xml">

</head>

<body>
    <nav class="navbar navbar-default visible-xs" role="navigation">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            
            <a type="button" class="navbar-toggle nav-link" href="http://github.com/johnpapa">
                <i class="fa fa-github"></i>
            </a>
            
            
            <a type="button" class="navbar-toggle nav-link" href="http://twitter.com/john_papa">
                <i class="fa fa-twitter"></i>
            </a>
            
            
            <a class="navbar-brand" href="/">
                <img src="http://www.gravatar.com/avatar/0d3794fe37746ea54926ca6878712721?s=35" class="img-circle" />
                
            </a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">
                <li class="active"><a href="/">Home</a></li>
                <li><a href="/categories.html">Categories</a></li>
                <li><a href="/tags.html">Tags</a></li>
            </ul>
        </div><!-- /.navbar-collapse -->
    </nav>

    <!-- nav-menu-dropdown -->
    <div class="btn-group hidden-xs" id="nav-menu">
        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
            <i class="fa fa-bars"></i>
        </button>
        <ul class="dropdown-menu" role="menu">
            <li><a href="/"><i class="fa fa-home"></i>Home</a></li>
            <li><a href="/categories.html"><i class="fa fa-folder"></i>Categories</a></li>
            <li><a href="/tags.html"><i class="fa fa-tags"></i>Tags</a></li>
            <li class="divider"></li>
            <li><a href="#"><i class="fa fa-arrow-up"></i>Top of Page</a></li>
        </ul>
    </div>

    <div class="col-sm-4 sidebar hidden-xs hidden-sm not-mobile">
        <!-- sidebar.html -->
<header class="sidebar-header" role="banner">
	<h1 class="text-center">John Papa</h1>
	<a href="/">
		<img src="http://www.gravatar.com/avatar/0d3794fe37746ea54926ca6878712721?s=150" class="img-circle" />
	</a>
	<h3 class="title">
		<a href="/"></a>
	</h3>
</header>


<div id="bio" class="text-center">
	Evangelist on the Loose
</div>


<div id="contact-list" class="text-center">
	<ul class="list-unstyled list-inline">
		
		<li>
			<a class="btn btn-default btn-sm" href="https://github.com/johnpapa">
				<i class="fa fa-github-alt fa-lg"></i>
			</a>
		</li>
		 
		<li>
			<a class="btn btn-default btn-sm" href="https://twitter.com/john_papa">
				<i class="fa fa-twitter fa-lg"></i>
			</a>
		</li>
		<li>
			<a class="btn btn-default btn-sm" href="/feed.xml">
				<i class="fa fa-rss fa-lg"></i>
			</a>
		</li>
	</ul>
	<ul id="contact-list-secondary" class="list-unstyled list-inline">
		 
	</ul>

	<div class="sidebar-content">

		<nav id="page-nav">
			<ul class="main-navigation list-unstyled list-inline">
				<li><a href="/about/">About</a></li>
				<li><a href="/articles">Articles</a></li>
				<li><a href="/spa">SPA</a></li>
				<li><a href="/videos">Videos</a></li>
			</ul>
		</nav>

		<h5>Recent Posts</h5>
		<ul class="list-unstyled">
			
				<li>
					<span>16 Sep 2015</span> &raquo;
					<a href="/angular/angular2/community/event/javascript/uncategorized/2015/09/16/angular-2-hack-night-coming-to-orlando.html">
					Angular 2 Hack Night Coming to Orlando</a>
				</li>
			
				<li>
					<span>29 Aug 2015</span> &raquo;
					<a href="/angular/asp.net/github/gulp/html5/javascript/pluralsight/typescript/uncategorized/visual%20studio%20code/2015/08/29/learning-visual-studio-code.html">
					Learning Visual Studio Code</a>
				</li>
			
				<li>
					<span>23 May 2015</span> &raquo;
					<a href="/uncategorized/2015/05/23/visual-studio-code-webinar.html">
					Visual Studio Code Webinar</a>
				</li>
			
				<li>
					<span>23 May 2015</span> &raquo;
					<a href="/uncategorized/2015/05/23/automatically-restarting-asp-net-on-osx-with-dnxmon.html">
					Automatically Restarting ASP.NET on OSX with DNXMON</a>
				</li>
			
				<li>
					<span>23 May 2015</span> &raquo;
					<a href="/uncategorized/2015/05/23/getting-started-with-asp-net-5-on-osx.html">
					Getting Started with ASP.NET 5 on OSX</a>
				</li>
			
				<li>
					<span>29 Apr 2015</span> &raquo;
					<a href="/uncategorized/2015/04/29/refactoring-with-visual-studio-code.html">
					Refactoring with Visual Studio Code</a>
				</li>
			
				<li>
					<span>29 Apr 2015</span> &raquo;
					<a href="/uncategorized/2015/04/29/intellisense-witha-visual-studio-code.html">
					Intellisense with Visual Studio Code</a>
				</li>
			
				<li>
					<span>29 Apr 2015</span> &raquo;
					<a href="/uncategorized/2015/04/29/git-and-preferences-in-visual-studio-code.html">
					Git and Preferences in Visual Studio Code</a>
				</li>
			
				<li>
					<span>29 Apr 2015</span> &raquo;
					<a href="/uncategorized/2015/04/29/debugging-with-visual-studio-code.html">
					Debugging with Visual Studio Code</a>
				</li>
			
				<li>
					<span>29 Apr 2015</span> &raquo;
					<a href="/uncategorized/2015/04/29/visual-studio-code.html">
					Introducing Visual Studio Code</a>
				</li>
			
		</ul>
	</div>

</div>
<!-- sidebar.html end -->
        <div class="not-mobile row sidebar-extras">
            <table class="col-centered">
                <tbody>
                    <tr>
                        <td>
                            <div data-type="ad" data-publisher="lqm.johnpapa.site" data-zone="ron" data-format="160x600"></div>
                        </td>
                        <td>
                            <div data-type="ad" data-publisher="lqm.johnpapa.site" data-zone="ron" data-format="160x600"></div>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <div data-type="ad" data-publisher="lqm.johnpapa.site" data-zone="ron" data-format="300x250"></div>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <div data-type="ad" data-publisher="lqm.johnpapa.site" data-zone="ron" data-format="300x250"></div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div class="col-sm-8">
        <div class="page-header">
  <h1>How to use npm global without sudo on OSX </h1>
</div>
	
<article>

	<div class="col-sm-10">
	 <span class="post-date">
	   
	   December 
	   28th,
	   
	   2014
	 </span>
	  <div class="article_body">
	  <p>When running npm and node, you may find yourself getting permission errors that ultimately lead you to using <code>sudo</code> in your commands. While this helps get around the issue in the short-term, it also places stricter permissions on those installs and it becomes a slippery slope where soon you may need sudo for more than you bargained for. Also, do you really want to be using <code>sudo</code> to install npm packages?</p>

<p>I went down this path and some experienced Mac developers helped me see why I needed to relieve myself of <code>sudo</code> for npm. Since then I’ve read several great posts with directions on how to do this including <a href="https://gist.github.com/DanHerbert/9520689">Dan Herbert’s fixing npm for Homebrew users</a> and <a href="https://github.com/sindresorhus/guides/blob/master/npm-global-without-sudo.md">Sindre Sorhus’s No Sudo instructions</a>. Each of these has something to offer, of which I combined into a single set of steps in this post. Also, special thanks to <a href="https://twitter.com/briannoyes">Brian Noyes</a>, <a href="https://twitter.com/wardbell">Ward Bell</a>, <a href="https://twitter.com/jesterxl">Jesse Warden</a>, <a href="https://twitter.com/walkingriver">Mike Callaghan</a>, and <a href="https://twitter.com/SamArtioli">Sam Artioli</a> for their help.</p>

<p>Some people already have node and npm packages. So there is some cleanup to do first. Others have fresh machines, so it’s a bit easier. While these steps are not the only way to go, they have been repeatable on a few machines for me. So why create a new set of instructions? For one, I can add some additional comments of what is going on to try to explain what’s really happening. Also, I was able to take some of the steps and make them all run from terminal, so you can literally copy and paste some of them (see where this is recommended below).</p>

<blockquote>
  Disclaimer: I offer no warranty nor guarantee of the success of these steps. These are simply what works in my experience. Follow these steps with a cautious eye as you would any steps you find on the internet.
</blockquote>

<p>I also encourage you to refer to either of the posts I mention above as they are both excellent and have also worked for me.</p>

<h2>What Are We Really Doing?</h2>

<p>Good question!  When node installs it puts npm packages in a specific folder, usually <code>/usr/local/lib/node_modules</code>. This location is what we are moving in these steps. Why? Because that location requires root permissions and thus the use of sudo proliferates needlessly. So these steps are all about moving the location of where the npm packages will live, and then pointing OSX and node to the new location via paths. Think of it as moving to a newer neighborhood :)</p>

<h2>Homebrew</h2>

<p>I assume you have <a href="http://brew.sh/">Homebrew</a>. If not, go get it. It’s awesome for OSX. You can install tons of great stuff quickly and efficiently with it. Instructions are at the link or for your convenience, run this:</p>

<p><code>ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"</code></p>

<h2>Already Have Node ?</h2>

<p>If you have Node installed already via brew, remove it and npm first. Run step 1 by itself and be careful, we are running as sudo and we are removing files forcefully.</p>

<ul>
<li>This removes, forcefully, everything in the old npm folders. 
<code>sudo rm -rf /usr/local/lib/node_modules</code>
<code>sudo rm -rf ~/.npm</code></li>
<li><p>This removes node and puts it back without npm
<code>brew uninstall node</code></p></li>
</ul>

<h2>Install Node and NPM</h2>

<ol>
<li><p>This adds node, sans npm
<code>brew install node --without-npm</code></p></li>
<li><p>Create a directory for your global packages. I prefer to name my folder <code>.npm-packages</code>, you can choose what you want as long as you replace it throughout these steps. The ${HOME} is a variable that translates to <code>~/</code> or <code>/Users/john/</code> for me.
<code>mkdir "${HOME}/.npm-packages"</code></p></li>
<li><p>Reference this directory for future usage in your <code>.bashrc</code> file. The <code>echo</code> command helps write the statement. The <code>&gt;&gt;</code> tells it where to write it which is followed by the file to write it to.
<code>echo NPM_PACKAGES="${HOME}/.npm-packages" &gt;&gt; ${HOME}/.bashrc</code></p></li>
<li><p>Indicate to npm where to store your globally installed package, in your <code>~/.npmrc</code> file.
<code>echo prefix=${HOME}/.npm-packages &gt;&gt; ${HOME}/.npmrc</code></p></li>
<li><p>This gets and installs the latest npm, which is 2.1.16 at the time of this writing.
<code>curl -L https://www.npmjs.org/install.sh | sh</code></p></li>
<li><p>Ensure node will find the packages by adding the path to your <code>.bashrc</code>. Notice the escape characters before special characters.
<code>echo NODE_PATH=\"\$NPM_PACKAGES/lib/node_modules\:\$NODE_PATH\" &gt;&gt; ${HOME}/.bashrc</code></p></li>
<li><p>Ensure you'll find installed binaries by adding the following to your <code>.bashrc</code>.
<code>echo PATH=\"\$NPM_PACKAGES/bin\:\$PATH\" &gt;&gt; ${HOME}/.bashrc</code></p></li>
<li><p>Ensure that you source your <code>.bashrc</code> file by adding the following to your <code>.bash_profile</code>.
<code>echo source "~/.bashrc" &gt;&gt; ${HOME}/.bash_profile</code></p></li>
<li><p>Source your <code>.bashrc</code> file once. Previous step did this for the future, but this does it right away.
<code>source ~/.bashrc</code></p></li>
</ol>

<blockquote>
  <p>These <code>echo</code> commands will create the file if it is not already there. But if the file is there, it will simply append these commands to the end of the file. If you already had these it will add a duplicate, which you then should remove. See the section below for details.


<h2>Checking Your Files</h2>

When you are done, you should have a files that looks something like the following:

<ul>
<li><code>~/.npmrc</code></li>
</ul>

<pre><code>prefix=/Users/john/.npm-packages
</code></pre>

<ul>
<li><code>~/.bashrc</code></li>
</ul>

<pre><code>NPM_PACKAGES=/Users/john/.npm-packages
NODE_PATH="$NPM_PACKAGES/lib/node_modules:$NODE_PATH"
PATH="$NPM_PACKAGES/bin:$PATH"
</code></pre>

<ul>
<li><code>~/.bash_profile</code></li>
</ul>

Make sure you have the <code>source ~/.bashrc</code> in your <code>~/.bash_profile</code>

<blockquote>
  <blockquote>
    To see the files beginning with <code>.</code> such as <code>.bashrc</code> and <code>.npmrc</code> you need to show hidden files for OSX. In terminal run the following command: <code>defaults write com.apple.finder AppleShowAllFiles YES</code>
  </blockquote>
</blockquote>

<h2>Verification</h2>

Run these commands to test if you were successful:

<ul>
<li>Run <code>node -v</code> to see the version of node</li>
<li>Run <code>npm -v</code> to see the version of npm</li>
<li>Run <code>npm list -g --depth=0</code> to see the global npm packages you have installed (should just be npm right now)</li>
</ul>

<h2>Advanced Users</h2>

For advanced users, the rest of these can be run via copy and paste into terminal.

<code class="prettyprint">
brew install node --without-npm
mkdir "${HOME}/.npm-packages"
echo NPM_PACKAGES="${HOME}/.npm-packages" &gt;&gt; ${HOME}/.bashrc
echo prefix=${HOME}/.npm-packages &gt;&gt; ${HOME}/.npmrc
curl -L https://www.npmjs.org/install.sh | sh
echo NODE_PATH=\"\$NPM_PACKAGES/lib/node_modules&#58;\$NODE_PATH\" &gt;&gt; ${HOME}/.bashrc
echo PATH=\"\$NPM_PACKAGES/bin&#58;\$PATH\" &gt;&gt; ${HOME}/.bashrc
echo source "~/.bashrc" &gt;&gt; ${HOME}/.bash_profile
source ~/.bashrc
</code>
</p></blockquote>

	  </div>

		
		<ul class="tag_box list-unstyled list-inline">
		  <li><i class="fa fa-folder-open"></i></li>
		  
		  
			 
				<li><a href="/categories.html#node-ref">
					node <span>(2)</span>
					,
				</a></li>
			 
				<li><a href="/categories.html#npm-ref">
					npm <span>(3)</span>
					,
				</a></li>
			 
				<li><a href="/categories.html#osx-ref">
					osx <span>(1)</span>
					,
				</a></li>
			 
				<li><a href="/categories.html#sudo-ref">
					sudo <span>(1)</span>
					,
				</a></li>
			 
				<li><a href="/categories.html#uncategorized-ref">
					uncategorized <span>(150)</span>
					
				</a></li>
			
		  
		</ul>
		  

		  

		<hr>

		<div>
      <section class="share col-sm-6">
        <h4 class="section-title">Share Post</h4>
        <a class="btn btn-default btn-sm twitter" href="http://twitter.com/share?text=How to use npm global without sudo on OSX&via=john_papa"
           onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
          <i class="fa fa-twitter fa-lg"></i>
          Twitter
        </a>
        <a class="btn btn-default btn-sm facebook" href="https://www.facebook.com/sharer/sharer.php"
           onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
          <i class="fa fa-facebook fa-lg"></i>
          Facebook
        </a>
        <a class="btn btn-default btn-sm gplus"
           onclick="window.open('https://plus.google.com/share?url='+window.location.href, 'google-plus-share', 'width=490,height=530');return false;">
          <i class="fa fa-google-plus fa-lg"></i>
          Google+
        </a>
      </section>

      <section class="col-sm-6 author">
        <img src="http://www.gravatar.com/avatar/0d3794fe37746ea54926ca6878712721" class="img-rounded author-image" />
        <h4 class="section-title author-name">John Papa</h4>
        <p class="author-bio">Evangelist on the Loose</p>
      </section>
    </div>

    <div class="clearfix"></div>

		<ul class="pager">
		  
		  <li class="previous"><a href="/angular/uncategorized/2014/12/27/route-resolve-and-controller-activate-in-angularjs.html" title="Route Resolve and Controller Activate in AngularJS">&larr; Previous</a></li>
		  
		  
		  <li class="next"><a href="/uncategorized/2015/01/04/orlando-code-camp-call-for-speakers.html" title="Orlando Code Camp Call for Speakers">Next &rarr;</a></li>
		  
		</ul>

		<hr>
	</div>
	
	<div class="col-sm-2 sidebar-2">
	
	</div>
</article>
<div class="clearfix"></div>



    
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'johnpapa';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>





      <footer class="footer-text">
        <hr/>
        <p>
        Copyright © 2015 - John Papa Blog content licensed under the Creative Commons <a href="http://creativecommons.org/licenses/by/2.5/">CC BY 2.5</a>
        | Unless otherwise stated or granted, code samples licensed under the <a href="http://sm.mit-license.org/">MIT license</a>.
        | Site design based on the <a href="https://github.com/dbtek/dbyll">dbyll theme</a> under the <a href="http://sm.mit-license.org/">MIT license</a>
      </p>

      </footer>

    </div>

    <script type="text/javascript" src="/assets/resources/jquery/jquery.min.js"></script>
    <script type="text/javascript" src="/assets/resources/bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/assets/js/app.js"></script>

    <!--Developer Media Links-->
    <script type='text/javascript'>
        function _dmBootstrap(file) {
    var _dma = document.createElement('script'); _dma.type = 'text/javascript'; _dma.async = true; _dma.src = ('https:' == document.location.protocol ? 'https://' : 'http://')
    + file;
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(_dma);
    }
    function _dmFollowup(file) { if (typeof DMAds === 'undefined') _dmBootstrap('cdn2.DeveloperMedia.com/a.min.js');}
    (function () { _dmBootstrap('cdn1.DeveloperMedia.com/a.min.js');
    setTimeout(_dmFollowup, 2000);})();
    </script>

    <!--<script language="JavaScript" src="http://ad.doubleclick.net/N6839/adj/lqm.johnpapa.site/ron;kw=%2Cjohn%2Cpapa%2Cblog%2Cjohnpapa%7Bdot%7Dnet%2Cjohnpapa%2Cpappa%2Cwww%7Bdot%7Djohnpapa%7Bdot%7Dnet%2Cjon%2Cangular%2Cjhon;sz=160x600;dc_ref=http%3A%2F%2Fwww.johnpapa.net%2F;tile=1;ord=BEAAB484DA88D8D84B9DCB004E5712BE?"
    type="text/javascript"></script>-->

    <div data-type="ad" data-publisher="lqm.johnpapa.site" data-zone="ron" data-format="728x90" class="col-centered"></div>

</body>

</html>


<!-- Asynchronous Google Analytics snippet -->
<script>
  var _gaq = _gaq || [];
  var pluginUrl =
 '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'johnpapa']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

