<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>JohnPapa.net</title>
    
    <meta name="author" content="John Papa">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

    <!-- Le styles -->
    <link href="/assets/resources/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/resources/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <link href="/assets/resources/syntax/syntax.css" rel="stylesheet">
    <link href="/assets/css/style.css" rel="stylesheet">

    <link rel="shortcut icon" type="image/x-icon" href="assets/ico/favicon.ico">

    <!-- Le fav and touch icons -->
    <!-- Update these with your own images
	<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
	-->

    <link rel="alternate" type="application/rss+xml" title="" href="/feed.xml">

</head>

<body>
    <nav class="navbar navbar-default visible-xs" role="navigation">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            
            <a type="button" class="navbar-toggle nav-link" href="http://github.com/johnpapa">
                <i class="fa fa-github"></i>
            </a>
            
            
            <a type="button" class="navbar-toggle nav-link" href="http://twitter.com/john_papa">
                <i class="fa fa-twitter"></i>
            </a>
            
            
            <a class="navbar-brand" href="/">
                <img src="http://www.gravatar.com/avatar/0d3794fe37746ea54926ca6878712721?s=35" class="img-circle" />
                
            </a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">
                <li class="active"><a href="/">Home</a></li>
                <li><a href="/categories.html">Categories</a></li>
                <li><a href="/tags.html">Tags</a></li>
            </ul>
        </div><!-- /.navbar-collapse -->
    </nav>

    <!-- nav-menu-dropdown -->
    <div class="btn-group hidden-xs" id="nav-menu">
        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
            <i class="fa fa-bars"></i>
        </button>
        <ul class="dropdown-menu" role="menu">
            <li><a href="/"><i class="fa fa-home"></i>Home</a></li>
            <li><a href="/categories.html"><i class="fa fa-folder"></i>Categories</a></li>
            <li><a href="/tags.html"><i class="fa fa-tags"></i>Tags</a></li>
            <li class="divider"></li>
            <li><a href="#"><i class="fa fa-arrow-up"></i>Top of Page</a></li>
        </ul>
    </div>

    <div class="col-sm-4 sidebar hidden-xs hidden-sm not-mobile">
        <!-- sidebar.html -->
<header class="sidebar-header" role="banner">
	<h1 class="text-center">John Papa</h1>
	<a href="/">
		<img src="http://www.gravatar.com/avatar/0d3794fe37746ea54926ca6878712721?s=150" class="img-circle" />
	</a>
	<h3 class="title">
		<a href="/"></a>
	</h3>
</header>


<div id="bio" class="text-center">
	Evangelist on the Loose
</div>


<div id="contact-list" class="text-center">
	<ul class="list-unstyled list-inline">
		
		<li>
			<a class="btn btn-default btn-sm" href="https://github.com/johnpapa">
				<i class="fa fa-github-alt fa-lg"></i>
			</a>
		</li>
		 
		<li>
			<a class="btn btn-default btn-sm" href="https://twitter.com/john_papa">
				<i class="fa fa-twitter fa-lg"></i>
			</a>
		</li>
		<li>
			<a class="btn btn-default btn-sm" href="/feed.xml">
				<i class="fa fa-rss fa-lg"></i>
			</a>
		</li>
	</ul>
	<ul id="contact-list-secondary" class="list-unstyled list-inline">
		 
	</ul>

	<div class="sidebar-content">

		<nav id="page-nav">
			<ul class="main-navigation list-unstyled list-inline">
				<li><a href="/about/">About</a></li>
				<li><a href="/articles">Articles</a></li>
				<li><a href="/spa">SPA</a></li>
				<li><a href="/videos">Videos</a></li>
			</ul>
		</nav>

		<h5>Recent Posts</h5>
		<ul class="list-unstyled">
			
				<li>
					<span>16 Sep 2015</span> &raquo;
					<a href="/angular/angular2/community/event/javascript/uncategorized/2015/09/16/angular-2-hack-night-coming-to-orlando.html">
					Angular 2 Hack Night Coming to Orlando</a>
				</li>
			
				<li>
					<span>29 Aug 2015</span> &raquo;
					<a href="/angular/asp.net/github/gulp/html5/javascript/pluralsight/typescript/uncategorized/visual%20studio%20code/2015/08/29/learning-visual-studio-code.html">
					Learning Visual Studio Code</a>
				</li>
			
				<li>
					<span>23 May 2015</span> &raquo;
					<a href="/uncategorized/2015/05/23/visual-studio-code-webinar.html">
					Visual Studio Code Webinar</a>
				</li>
			
				<li>
					<span>23 May 2015</span> &raquo;
					<a href="/uncategorized/2015/05/23/automatically-restarting-asp-net-on-osx-with-dnxmon.html">
					Automatically Restarting ASP.NET on OSX with DNXMON</a>
				</li>
			
				<li>
					<span>23 May 2015</span> &raquo;
					<a href="/uncategorized/2015/05/23/getting-started-with-asp-net-5-on-osx.html">
					Getting Started with ASP.NET 5 on OSX</a>
				</li>
			
				<li>
					<span>29 Apr 2015</span> &raquo;
					<a href="/uncategorized/2015/04/29/refactoring-with-visual-studio-code.html">
					Refactoring with Visual Studio Code</a>
				</li>
			
				<li>
					<span>29 Apr 2015</span> &raquo;
					<a href="/uncategorized/2015/04/29/intellisense-witha-visual-studio-code.html">
					Intellisense with Visual Studio Code</a>
				</li>
			
				<li>
					<span>29 Apr 2015</span> &raquo;
					<a href="/uncategorized/2015/04/29/git-and-preferences-in-visual-studio-code.html">
					Git and Preferences in Visual Studio Code</a>
				</li>
			
				<li>
					<span>29 Apr 2015</span> &raquo;
					<a href="/uncategorized/2015/04/29/debugging-with-visual-studio-code.html">
					Debugging with Visual Studio Code</a>
				</li>
			
				<li>
					<span>29 Apr 2015</span> &raquo;
					<a href="/uncategorized/2015/04/29/visual-studio-code.html">
					Introducing Visual Studio Code</a>
				</li>
			
		</ul>
	</div>

</div>
<!-- sidebar.html end -->
        <div class="not-mobile row sidebar-extras">
            <table class="col-centered">
                <tbody>
                    <tr>
                        <td>
                            <div data-type="ad" data-publisher="lqm.johnpapa.site" data-zone="ron" data-format="160x600"></div>
                        </td>
                        <td>
                            <div data-type="ad" data-publisher="lqm.johnpapa.site" data-zone="ron" data-format="160x600"></div>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <div data-type="ad" data-publisher="lqm.johnpapa.site" data-zone="ron" data-format="300x250"></div>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <div data-type="ad" data-publisher="lqm.johnpapa.site" data-zone="ron" data-format="300x250"></div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div class="col-sm-8">
        <div class="page-header">
  <h1>JohnPapa.net </h1>
</div>



<article class="home">

  <span class="post-date">
    
    September
    14th,
    
    2008
  </span>

  <h2>
    <a href="/silverlight/2008/09/14/linq-to-json-ndash-checking-for-an-object-or-array.html">LINQ to JSON – Checking for an Object or Array</a>
  </h2>

  <div>
    
    
    <p>&nbsp;</p>
<p>I was writing an event handler for <a href="/data-services-with-silverlight-2/book-summary-for-data-services-with-silverlight-2-on-amazon-now/">my book</a> that consumes a stream of JSON from a RESTful service. The handler is called when one of several asynchronous events is invoked. All of these events request a steam of either 1 or more products to be returned as JSON. So I wanted this handler to be able to consume the JSON whether it was a single product or an array of products.</p>
<p>The JSON is not wrapped, so a single object will not convert to a JsonArray. What I really wanted was to avoid writing the same LINQ to JSON query just to change out if it was looking for an object or an array. The way I handled this is to parse the raw JSON (a string variable) into a JsonArray object. If the JSON is a single object then when it is cast to a JsonArray it will be null. So at that point I know if it is an array of products or a single product.</p>
<p>Then, in the IF statement if it is a single object I parse the JSON into a JsonObject, create an instance of a JsonArray and add the JsonObject to the JsonArray. If the JSON data can be parsed into a JsonArray, the ELSE section parses it into a JsonArray. So in the end I have a JsonArray of either 1 or more objects. Why is this important? Because the query can now be written to find a list of products without having to handle wether it comes form a JsonObject or against a JsonArray.</p>
<p><strong>C#</strong></p>
<div>
<div style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: white; border-bottom-style: none"><span style="color: #0000ff">private</span> <span style="color: #0000ff">void</span> ParseProducts_AsJson(<span style="color: #0000ff">object</span> sender, DownloadStringCompletedEventArgs e)</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">
{</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: white; border-bottom-style: none">
<span style="color: #0000ff">string</span> raw = e.Result;</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">
&nbsp;</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: white; border-bottom-style: none">
JsonArray json;</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">
<span style="color: #0000ff">if</span> (JsonArray.Parse(raw) <span style="color: #0000ff">as</span> JsonArray == <span style="color: #0000ff">null</span>)</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: white; border-bottom-style: none">
json = <span style="color: #0000ff">new</span> JsonArray {JsonObject.Parse(raw) <span style="color: #0000ff">as</span> JsonObject};</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">
<span style="color: #0000ff">else</span></pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: white; border-bottom-style: none">
json = JsonArray.Parse(raw) <span style="color: #0000ff">as</span> JsonArray;</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">
&nbsp;</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: white; border-bottom-style: none">
var query = from product <span style="color: #0000ff">in</span> json</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">
select <span style="color: #0000ff">new</span> Product</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: white; border-bottom-style: none">
{</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">
ProductId = (<span style="color: #0000ff">int</span>)product[<span style="color: #006080">&quot;ProductId&quot;</span>],</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: white; border-bottom-style: none">
ProductName = (<span style="color: #0000ff">string</span>)product[<span style="color: #006080">&quot;ProductName&quot;</span>],</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">
UnitPrice = (<span style="color: #0000ff">decimal</span>)product[<span style="color: #006080">&quot;UnitPrice&quot;</span>]</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: white; border-bottom-style: none">
};</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">
List&lt;Product&gt; products = query.ToList() <span style="color: #0000ff">as</span> List&lt;Product&gt;;</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: white; border-bottom-style: none">
lstProducts.DataContext = products;</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">
}</pre>
</div>
</div>
<p><strong>VB</strong></p>
<div>
<div style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: white; border-bottom-style: none"><span style="color: #0000ff">Private</span> <span style="color: #0000ff">Sub</span> ParseProducts_AsJson(<span style="color: #0000ff">ByVal</span> sender <span style="color: #0000ff">As</span> <span style="color: #0000ff">Object</span>, _</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">
<span style="color: #0000ff">ByVal</span> e <span style="color: #0000ff">As</span> DownloadStringCompletedEventArgs)</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: white; border-bottom-style: none">
<span style="color: #0000ff">Dim</span> raw <span style="color: #0000ff">As</span> <span style="color: #0000ff">String</span> = e.Result</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">
&nbsp;</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: white; border-bottom-style: none">
<span style="color: #0000ff">Dim</span> json <span style="color: #0000ff">As</span> JsonArray</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">
<span style="color: #0000ff">If</span> <span style="color: #0000ff">TryCast</span>(JsonArray.Parse(raw), JsonArray) <span style="color: #0000ff">Is</span> <span style="color: #0000ff">Nothing</span> <span style="color: #0000ff">Then</span></pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: white; border-bottom-style: none">
json = <span style="color: #0000ff">New</span> JsonArray <span style="color: #0000ff">With</span> _</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">
{<span style="color: #0000ff">TryCast</span>(JsonObject.Parse(raw), JsonObject)}</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: white; border-bottom-style: none">
<span style="color: #0000ff">Else</span></pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">
json = <span style="color: #0000ff">TryCast</span>(JsonArray.Parse(raw), JsonArray)</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: white; border-bottom-style: none">
<span style="color: #0000ff">End</span> <span style="color: #0000ff">If</span></pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">
&nbsp;</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: white; border-bottom-style: none">
<span style="color: #0000ff">Dim</span> query = _</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">
From product <span style="color: #0000ff">In</span> json _</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: white; border-bottom-style: none">
<span style="color: #0000ff">Select</span> <span style="color: #0000ff">New</span> Product <span style="color: #0000ff">With</span> </pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">
{.ProductId = <span style="color: #0000ff">CInt</span>(Fix(product(<span style="color: #006080">&quot;ProductId&quot;</span>))), _</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: white; border-bottom-style: none">
.ProductName = <span style="color: #0000ff">CStr</span>(product(<span style="color: #006080">&quot;ProductName&quot;</span>)), _</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">
.UnitPrice = <span style="color: #0000ff">CDec</span>(product(<span style="color: #006080">&quot;UnitPrice&quot;</span>))}</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: white; border-bottom-style: none">
<span style="color: #0000ff">Dim</span> products <span style="color: #0000ff">As</span> List(Of Product) = _</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">
<span style="color: #0000ff">TryCast</span>(query.ToList(), List(Of Product))</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: white; border-bottom-style: none">
lstProducts.DataContext = products</pre>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none"><span style="color: #0000ff">End</span> Sub</pre>
</div>
</div>
<p>If there is a better way, I am certainly open to it. I&rsquo;d love to see some additional methods on these objects to allow a little more variation. But overall I am thrilled to see LINQ to JSON! Now, too bad I can&rsquo;t create an anonymous type from this LINQ query and bind it to the XAML. Wishes and dream for the next version :)</p>
<div class="wlWriterHeaderFooter" style="padding-right: 4px; padding-left: 4px; padding-bottom: 4px; margin: 0px; padding-top: 4px; text-align: left"><a href="http://www.dotnetkicks.com/kick/?url=/all/linq-to-json-ndash-checking-for-an-object-or-array/"><img alt="DotNetKicks Image" border="0" src="http://www.dotnetkicks.com/Services/Images/KickItImageGenerator.ashx?url=/all/linq-to-json-ndash-checking-for-an-object-or-array/&amp;bgcolor=0080C0&amp;fgcolor=FFFFFF&amp;border=000000&amp;cbgcolor=D4E1ED&amp;cfgcolor=000000" /></a></div>
<div class="wlWriterHeaderFooter" style="padding-right: 4px; padding-left: 4px; padding-bottom: 4px; margin: 0px; padding-top: 4px; text-align: left"><script type="text/javascript">var dzone_url = '/all/linq-to-json-ndash-checking-for-an-object-or-array/'; var dzone_title = 'LINQ to JSON – Checking for an Object or Array'; var dzone_blurb = 'LINQ to JSON – Checking for an Object or Array'; var dzone_style = '2';</script><script language="javascript" src="http://widgets.dzone.com/widgets/zoneit.js"></script></div>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    September
    13th,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/09/13/update-for-windows-live-writer-dzone-plugin-on-codeplex.html">Update for Windows Live Writer DZone PlugIn on CodePlex</a>
  </h2>

  <div>
    
    
    <p></p>
<p>I made some revisions to my <a href="/all/dzone-plugin-for-windows-live-writer/">DZone plugin for Windows Live Writer</a> and put the <a href="http://www.codeplex.com/wlwplugin4dzone">source code and the DLL up on CodePlex</a>. The new version is v1.0.0.5. There were a few minor tweaks to the code, but the most notable changes are that I added a preview of the DZone tag to the options dialog. Now when you select the tag type it will show you a preview of the tag in an image. Nothing major, but something I had ben meaning to do.</p>
<p><img title="image" style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="216" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/UpdateforWindowsLiveWriterDZonePlugInonC_D566/image_6.png" width="240" border="0" />&#160; <img title="image" style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="216" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/UpdateforWindowsLiveWriterDZonePlugInonC_D566/image_5.png" width="240" border="0" /> </p>
<p>If you are interested in learning more about the DZone plugin, you can <a href="/all/dzone-plugin-for-windows-live-writer/">check out my first post on the topic here</a>.</p>
<div class="wlWriterHeaderFooter" style="text-align:left; margin:0px; padding:4px 4px 4px 4px;"><a href="http://www.dotnetkicks.com/kick/?url=/all/update-for-windows-live-writer-dzone-plugin-on-codeplex/"><img src="http://www.dotnetkicks.com/Services/Images/KickItImageGenerator.ashx?url=/all/update-for-windows-live-writer-dzone-plugin-on-codeplex/&amp;bgcolor=0080C0&amp;fgcolor=FFFFFF&amp;border=000000&amp;cbgcolor=D4E1ED&amp;cfgcolor=000000" alt="DotNetKicks Image" border="0/" /></a></div>
<div class="wlWriterHeaderFooter" style="text-align:left; margin:0px; padding:4px 4px 4px 4px;"><script type="text/javascript">var dzone_url = '/all/update-for-windows-live-writer-dzone-plugin-on-codeplex/'; var dzone_title = 'Update for Windows Live Writer DZone PlugIn on CodePlex'; var dzone_blurb = 'Update for Windows Live Writer DZone PlugIn on CodePlex'; var dzone_style = '2';</script><script language="javascript" src="http://widgets.dzone.com/widgets/zoneit.js"></script> </div>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    September
    12th,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/09/12/iphone-2-1-update-ndash-big-promises.html">iPhone 2.1 Update – Big Promises</a>
  </h2>

  <div>
    
    
    <p></p>
<p>I’ve loved my iPhone so far. It has some awesome features, keeps me connected to work, allows me to not carry an iPod and a phone, and the AppStore is killer. But there are some well documented issues from many users. The battery life is horrific. I cannot get through half a day of normal without having to charge it. Apple’s solution … turn off WiFi, location services, bluetooth and 3G.&#160; Um, OK. That’s like buying a Ferrari and going 10MPH in it to save gas. Come on Apple, get serious!</p>
<div>So <a href="http://computerworld.com/action/article.do?command=viewArticleBasic&amp;articleId=9114398">Jobs comes out and says that with the 2.1 update</a> that was released today that it promises to fix a lot of bugs and address some big concerns such as:</div>
<ul>   <li>improved battery life </li>    <li>fewer call drops </li>    <li>less crashes </li>    <li>less time to synch with iTunes </li> </ul>
<p>These are the 4 biggest problems I have noticed so far. I would put them in the order I listed them above, too. Battery life is just horrible. A mobile device has to get through a day’s use. And for someone who uses the mobile device a lot, especially when traveling I am lost without a mobile device. Sometimes its just not practical to whip out the laptop. I can get through a day if I do nothing on the phone but check email every 30 minutes. That’s just silly.</p>
<p>Call drops … you know, if they can limit them, that’s great! But I don’t know if I believe they can do this. Most call drops I chalk up to poor reception in my area as it toggles between EVDO and 3G with 0 bars to 5 bars. </p>
<p>My iPhone does not crash often, probably once a week. But my first iPhone crashed several times in the week I had it. I returned it for this reason (and so I could get the 16gb device). But my wife and father both have an iPhone and they experience more crashes than I do. So less crashes is a good thing we are looking forward to.</p>
<p>Time to synch with iTunes … its a hassle for sure, but I don’t really mind it too much most of the time. I just let it run in the background. The backups can be very long … a few of them took about an hour for my phone, probably due to all the music and videos on it. So if that can be decreased, then that’s good.</p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p>So I just updated to 2.1 while I wrote this post. It took under 10 minutes from start to finish. I’ll post more on the results of these promises from Apple as I test it out this weekend. But man, I am looking forward to the possibility that Apple may deliver this time. &lt;crossingfingers/&gt;</p>
<div class="wlWriterHeaderFooter" style="text-align:left; margin:0px; padding:4px 4px 4px 4px;"><a href="http://www.dotnetkicks.com/kick/?url=/all/iphone-2-1-update-ndash-big-promises/"><img src="http://www.dotnetkicks.com/Services/Images/KickItImageGenerator.ashx?url=/all/iphone-2-1-update-ndash-big-promises/&amp;bgcolor=0080C0&amp;fgcolor=FFFFFF&amp;border=000000&amp;cbgcolor=D4E1ED&amp;cfgcolor=000000" alt="DotNetKicks Image" border="0/" /></a></div>
<div class="wlWriterHeaderFooter" style="text-align:left; margin:0px; padding:4px 4px 4px 4px;"><script type="text/javascript">var dzone_url = '/all/iphone-2-1-update-ndash-big-promises/'; var dzone_title = 'iPhone 2.1 Update – Big Promises'; var dzone_blurb = 'iPhone 2.1 Update – Big Promises'; var dzone_style = '2';</script><script language="javascript" src="http://widgets.dzone.com/widgets/zoneit.js"></script> </div>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    September
    11th,
    
    2008
  </span>

  <h2>
    <a href="/silverlight/2008/09/11/more-information-on-data-services-with-silverlight-2-at-o-rsquo-reilly.html">More Information on Data Services with Silverlight 2 at O’Reilly</a>
  </h2>

  <div>
    
    
    <p>&nbsp;</p>
<p>&nbsp;</p>
<p>O&rsquo;Reilly has been busy making preparations for my book lately. One of the items on there list was to get the information about <a href="http://oreilly.com/catalog/9780596523091/">my book up and on their web site</a>. So my book is now listed on the O&rsquo;Reilly site including a description of the contents. Soon to come will be the TOC and other information as it unfolds. You can pre-order it right on their site, too.</p>
<p>We have discussed the idea of bundling my book with the Silverlight 2 book by Tim Heuer and Jesse Liberty. Nothing concrete yet on that, but the first place to look for that would be the O&rsquo;Reilly site.</p>
<p>Here is the description, taken from the site:</p>
<p><strong>Book description</strong></p>
<p>This comprehensive tutorial teaches developers how to build data-rich applications with Silverlight 2 that draw on multiple sources of data, including how to implement &quot;in-the-cloud&quot; data access options. Packed with reusable examples, <em>Data Services with Silverlight 2</em> offers valuable information on data binding controls, LINQ, RESTful and WCF interfaces, cross-domain data, as well as Microsoft's new ADO.NET Data Services and the ADO.NET Entity Framework. <br />
&nbsp;</p>
<p><img title="Data Services With Silverlight 2 - Amazon cover.- Medium" style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; margin: 5px 10px 5px 0px; border-right-width: 0px" height="240" alt="Data Services With Silverlight 2 - Amazon cover.- Medium" width="183" align="left" border="0" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/MoreInformationonDataServiceswithSilverl_D89F/Data%20Services%20With%20Silverlight%202%20-%20Amazon%20cover.-%20Medium_3.png" />There's tremendous interest in building applications with Silverlight 2, but very little material demonstrating how to build data-driven solutions with the platform. This comprehensive tutorial teaches developers how to build data-rich applications with Silverlight 2 that draw on multiple sources of data, including how to implement &quot;in-the-cloud&quot; data access options. <br />
Packed with reusable examples, Data Services with Silverlight 2 offers valuable information on data binding controls, the LINQ data querying component, RESTful and WCF interfaces, cross-domain data, as well as Microsoft's new ADO.NET Data Services and the ADO.NET Entity Framework. With this book, you will:</p>
<ul>
<li>Learn how Silverlight 2 applications rely on data for binding, passing, reading, saving, querying, and presentation</li>
<li>Discover how your application can call REST, web services, RSS, and HTTP services</li>
<li>Design entities that can be passed to and from a Silverlight 2 application via WCF</li>
<li>Apply data persistence techniques to Silverlight 2 applications</li>
<li>Harness the power of RESTful web services such as Amazon and Twitter</li>
<li>Learn how and when to use LINQ to SQL to query a data store</li>
<li>Retrieve and save data, using the new Entity Framework and WCF</li>
<li>Work with the RESTful ADO.NET Data Services to move data between your application and a database</li>
<li>Learn how to build RESTful services and communicate with them from Silverlight 2</li>
</ul>
<p>And more. Written by data access expert and MSDN Magazine columnist <a href="/">John Papa</a>, <em>Data Services with Silverlight 2</em> covers all of the Silverlight data access topics you need to know, including the real-world scenarios you're most likely to encounter. <br />
Examples will be available on the book's web site at <a href="http://www.silverlight2data.com">www.silverlight2data.com</a>.</p>
<div class="wlWriterHeaderFooter" style="padding-right: 4px; padding-left: 4px; padding-bottom: 4px; margin: 0px; padding-top: 4px; text-align: left"><a href="http://www.dotnetkicks.com/kick/?url=/data-services-with-silverlight-2/more-information-on-data-services-with-silverlight-2-at-o-rsquo-reilly/"><img alt="DotNetKicks Image" border="0" src="http://www.dotnetkicks.com/Services/Images/KickItImageGenerator.ashx?url=/data-services-with-silverlight-2/more-information-on-data-services-with-silverlight-2-at-o-rsquo-reilly/&amp;bgcolor=0080C0&amp;fgcolor=FFFFFF&amp;border=000000&amp;cbgcolor=D4E1ED&amp;cfgcolor=000000" /></a></div>
<div class="wlWriterHeaderFooter" style="padding-right: 4px; padding-left: 4px; padding-bottom: 4px; margin: 0px; padding-top: 4px; text-align: left"><script type="text/javascript"><!-- var dzone_url = '/data-services-with-silverlight-2/more-information-on-data-services-with-silverlight-2-at-o-rsquo-reilly/'; var dzone_title = 'More Information on Data Services with Silverlight 2 at O’Reilly'; var dzone_blurb = 'More Information on Data Services with Silverlight 2 at O’Reilly'; var dzone_style = '2'; --></script><script language="javascript" src="http://widgets.dzone.com/widgets/zoneit.js"></script></div>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    September
    10th,
    
    2008
  </span>

  <h2>
    <a href="/silverlight/2008/09/10/can-rsquo-t-rest-with-rest.html">Can’t REST with REST</a>
  </h2>

  <div>
    
    
    <p>&nbsp;</p>
<p>&nbsp;</p>
<p>I just finished another chapter of <a href="http://www.amazon.com/exec/obidos/ASIN/0596523092/johnpanet-20">Data Services with Silverlight 2</a>. It&rsquo;s a great feeling when this happens. There is always a bit of a slight pause afterwards though as I begin to realize how much more I have to write. For example, I finished a chapter on using RESTful services from Amazon to <a href="http://www.amazon.com/exec/obidos/ASIN/0596523092/johnpanet-20"><img title="DSS2 cover - xlarge" style="border-right: 0px; border-top: 0px; margin: 5px 5px 5px 0px; border-left: 0px; border-bottom: 0px" height="316" alt="DSS2 cover - xlarge" width="241" align="left" border="0" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/CantRESTwithREST_14EF0/DSS2%20cover%20-%20xlarge_3.png" /></a>create a Silverlight 2 based shopping application. Its a case study really &hellip; and it follows a chapter that discusses a primer of REST as it pertains to Silverlight 2, WebClient, HttpWebRequest, and many other issues.&nbsp;</p>
<p>But as I finished these 2 chapters I am now going to dive into writing a chapter that shows how to build RESTful services that can be consumed by a Silverlight 2 application. This includes POSTs, Gets, Uri Templates, message formats, LINQ to JSON, and much more. To tie it all together I decided to build a RESTful service that interacts with Twitter&rsquo;s RESTful API &hellip; and a Twitter client that I call SilverTwit that consumes both. So there is so much much more to go on the topic of REST and Silverlight 2. Oh, and then I still have to wrap up the Syndication and Astoria chapters. The good news is that I have created all of the chapter outlines, then I created the sample code, so the chapters just flow at this point. That&rsquo;s why I can now write 10 pages in a day whereas before I was working on dozens of examples to base the book on.</p>
<p>My style is to discuss the topics and then demonstrate them in a case study like format while including the complete source code for the samples. I&rsquo;ll put all of the code on the web site once I am done, in both VB and C# (thanks to <a href="/all/instant-vb-and-instant-c-ndash-paying-huge-dividends/">Instant VB</a>). Many of the examples can be expanded easily, and I hope people do take on that task.</p>
<p>But for tonight, I am just happy that another milestone is reached!</p>
<div class="wlWriterHeaderFooter" style="padding-right: 4px; padding-left: 4px; padding-bottom: 4px; margin: 0px; padding-top: 4px; text-align: left"><a href="http://www.dotnetkicks.com/kick/?url=/data-services-with-silverlight-2/can-rsquo-t-rest-with-rest/"><img alt="DotNetKicks Image" border="0" src="http://www.dotnetkicks.com/Services/Images/KickItImageGenerator.ashx?url=/data-services-with-silverlight-2/can-rsquo-t-rest-with-rest/&amp;bgcolor=0080C0&amp;fgcolor=FFFFFF&amp;border=000000&amp;cbgcolor=D4E1ED&amp;cfgcolor=000000" /></a></div>
<div class="wlWriterHeaderFooter" style="padding-right: 4px; padding-left: 4px; padding-bottom: 4px; margin: 0px; padding-top: 4px; text-align: left"><script type="text/javascript"><!-- var dzone_url = '/data-services-with-silverlight-2/can-rsquo-t-rest-with-rest/'; var dzone_title = 'Can’t REST with REST'; var dzone_blurb = 'Can’t REST with REST'; var dzone_style = '2'; --></script><script language="javascript" src="http://widgets.dzone.com/widgets/zoneit.js"></script></div>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    September
    10th,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/09/10/instant-vb-and-instant-c-ndash-paying-huge-dividends.html">Instant VB and Instant C# – Paying Huge Dividends</a>
  </h2>

  <div>
    
    
    <p></p>
<p>I’ve been using <a href="http://tangiblesoftwaresolutions.com/">Instant VB</a> for a few months now to convert code snippets in my <a href="http://www.amazon.com/exec/obidos/ASIN/0596523092/johnpanet-20">Silverlight 2 book</a> from C# to VB. I tried a few free tools, but they just could not compare with the experience I had with Instant VB. For small snippets its nice. It converts them very quickly and accurately. But where the product really shines is in converting&#160; an entire solution full of several project and a ton of files. It converts large amounts of code very fast which is awesome for me …&#160; as I am using it to convert several C# solutions to VB for my book. As I go through each chapter I convert the entire project to VB and it just flies through the code. Here is a smaller solution that it converted in 4 seconds.</p>
<p></p>
<p></p>
<p></p>
<p><img title="image" style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="159" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/InstantVBandInstantCPayingHugeDividends_12778/image_3.png" width="479" border="0" /> </p>
<p>The best part of the software is the support. Every single problem I have had where a conversion did not do what I expected was fixed within a week. Seriously! I am writing the book with beta software and CTP versions of toolkits, so I expect some issues. As I have encountered them I have gotten emails back within a few days (and sometimes the same day) with a new version posted on the web site with a fix.</p>
<p><strong>Disclaimer</strong>: I started out trying this software using the trial version. When I first started encountering problems due to the Silverlight 2 beta bits and converting it, Tangible offered me the software license for free since we were helping each other out. I was helping find issues with the conversions in the Silverlight 2 conversions which helps their product get better and obviously I benefit from using the software. So yes, I am getting something out of this software … but anyone who knows me knows that even when I get free software if I did not like it, I would NOT give it a good review. I have absolutely loved using this software as it has saved me hours of time.</p>
<div class="wlWriterHeaderFooter" style="text-align:left; margin:0px; padding:4px 4px 4px 4px;"><a href="http://www.dotnetkicks.com/kick/?url=/all/instant-vb-and-instant-c-ndash-paying-huge-dividends/"><img src="http://www.dotnetkicks.com/Services/Images/KickItImageGenerator.ashx?url=/all/instant-vb-and-instant-c-ndash-paying-huge-dividends/&amp;bgcolor=0080C0&amp;fgcolor=FFFFFF&amp;border=000000&amp;cbgcolor=D4E1ED&amp;cfgcolor=000000" alt="DotNetKicks Image" border="0/" /></a></div>
<div class="wlWriterHeaderFooter" style="text-align:left; margin:0px; padding:4px 4px 4px 4px;"><script type="text/javascript"><!-- var dzone_url = '/all/instant-vb-and-instant-c-ndash-paying-huge-dividends/'; var dzone_title = 'Instant VB and Instant C# – Paying Huge Dividends'; var dzone_blurb = 'Instant VB and Instant C# – Paying Huge Dividends'; var dzone_style = '2'; --></script><script language="javascript" src="http://widgets.dzone.com/widgets/zoneit.js"></script> </div>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    September
    9th,
    
    2008
  </span>

  <h2>
    <a href="/silverlight/2008/09/09/linq-to-xml-tip-checking-for-values.html">LINQ to XML Tip - Checking for Values</a>
  </h2>

  <div>
    
    
    <p>This tip comes right from some of the examples I am writing for my book Data Services with Silverlight 2. I was writing a LINQ query definition&nbsp; for LINQ to XML that parses through a response from an Amazon RESTful web service when I realized I cannot be sure if a book will have a price stored in this XML element, or that element, or some other element. So I had to check to see what element existed and contained the appropriate value.</p>
<p>So I ran a query like this:</p>
<div class="csharpcode">
<pre class="alt">
var bookQuery = </pre>
<pre>
from book <span class="kwrd">in</span> bookXml.Descendants(<span class="str">&quot;Item&quot;</span>)</pre>
<pre class="alt">
&nbsp;</pre>
<pre>
let attributes = book.Element(<span class="str">&quot;ItemAttributes&quot;</span>)</pre>
<pre class="alt">
&nbsp;</pre>
<pre>
let price = Decimal.Parse((</pre>
<pre class="alt">
book.Elements(<span class="str">&quot;OfferSummary&quot;</span>).Any() </pre>
<pre>
&amp;&amp; book.Element(<span class="str">&quot;OfferSummary&quot;</span>).Elements(<span class="str">&quot;LowestNewPrice&quot;</span>).Any()</pre>
<pre class="alt">
? book.Element(<span class="str">&quot;OfferSummary&quot;</span>).Element(<span class="str">&quot;LowestNewPrice&quot;</span>).Element(<span class="str">&quot;Amount&quot;</span>).Value</pre>
<pre>
: (attributes.Elements(<span class="str">&quot;ListPrice&quot;</span>).Any()</pre>
<pre class="alt">
? attributes.Element(<span class="str">&quot;ListPrice&quot;</span>).Element(<span class="str">&quot;Amount&quot;</span>).Value </pre>
<pre>
: <span class="str">&quot;0&quot;</span>))) / 100</pre>
<pre class="alt">
&nbsp;</pre>
<pre>
select <span class="kwrd">new</span> {Price = price};</pre>
</div>
<p><style type="text/css">.csharpcode, .csharpcode pre
{
font-size: small;
color: black;
font-family: consolas, "Courier New", courier, monospace;
background-color: #ffffff;
/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt
{
background-color: #f4f4f4;
width: 100%;
margin: 0em;
}
.csharpcode .lnum { color: #606060; }</style><style type="text/css">.csharpcode, .csharpcode pre
{
font-size: small;
color: black;
font-family: consolas, "Courier New", courier, monospace;
background-color: #ffffff;
/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt
{
background-color: #f4f4f4;
width: 100%;
margin: 0em;
}
.csharpcode .lnum { color: #606060; }</style></p>
<p>The problem was that the price could be stored in the OfferSummary element if an offer exists for the item (a book in my case). But the OfferSummary element ay not even exist. If it does, then I have to check for the LowestNewPrice element and it may not exist. Finally if it does, I go ge the Amount element and grab its value. Otherwise I have to get get the ListPrice element. But it may not exist either. I think you get the point ... sometimes the elements exist and sometimes they don't.</p>
<p>So one way around this is to check if the element exists by using the Elements collection (instead of the Element ... singular) and using its Any() method. This returns a boolean value that tells if any items exist in that collection. So the above code makes sure I get a price whether it be the lower offer price or the current list price (as a fallback). If no price exists, it returns a 0. All of this is done outside of the select statement in the LINQ query definition. This allows the select to remain unclutterred. As you can see, the let statement for the price got ugly quick.</p>
<p>Using the Elements(&quot;foo&quot;).Any() technique is pretty easy to do and makes it easier to grab a value and prep.</p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    September
    9th,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/09/09/registration-open-for-day-of-silverlight-2.html">Registration Open for Day of Silverlight 2</a>
  </h2>

  <div>
    
    
    <p>Now that my book writing is slowing down as my Silverlight 2 book is getting ready to go to print, I've been preparing for a series of Silverlight 2 events. I had a great turnout for my Silverlight 2 and data services session yesterday in VSLive NY. I wish I had more time to go through all of the material I wanted to, but it was a jam packed session of Silverlight and the cloud goodness as it a was.</p>
<p><a href="http://msevents.microsoft.com/CUI/EventDetail.aspx?EventID=1032387218&amp;culture=en-US">My next event</a> will leave more time to talk about Silverlight 2, REST services, bindings, Blend, WCF, RSS and more since it is a half day. And its free! <a href="http://msevents.microsoft.com/CUI/EventDetail.aspx?EventID=1032387218&amp;culture=en-US">Registration is open for our Day of Silverlight 2</a> hosted at the Microsoft offices in Tampa Florida on Friday, October 24th. Joe Healy has been kind enough to set up this free event at the Microsoft offices in Tampa, FL and to invite me to present this great topic. We'll be giving away lots of cool swag including a bunch of Silverlight and related books donated from Microsoft Press and O'Reilly Media. We'll also be heading off to a late lunch afterwards to talk about any offshoots that may pop up. his is a great chance to see what's coming in Silverlight 2 and hear about the future of this technology. </p>
<p>I hope to see you there!</p>
<p> <dt>Microsoft Office – Tampa, FL<br />5426 Bay Center Drive, Suite 7005426 Bay Center Drive, Suite 700  <dt> <p>Tampa, FL 33609 </p> <p></p> <dt>Friday, October 24, 2008 <br />9:00 AM–12:00 PM <br /><a href="http://msevents.microsoft.com/CUI/EventDetail.aspx?EventID=1032387218&amp;culture=en-US">Click here to register</a> or call 877.673.8368 with event ID <b>1032387218</b> <br /> <dt> <dt> <p>Title: Day of Silverlight 2.0 - Data Access – with John Papa</p> <ul> <li>Data Binding Foundations, Notifications, Modes, Lists, and Value Converters  <li>Consuming SOAP with WCF and ASMX, POX and REST services, and Syndication  <li>LINQ to XML &amp; LINQ to JSON  <li>Building REST styled services with Silverlight to 3rd Party API’s  <li>Using Visual Studio and Blend and to develop Silverlight applications</li> <p> <p>&nbsp;</p>



</p></li></li></li></li></ul></dt></dt></dt></dt></dt></p>

    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    September
    7th,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/09/07/arrived-in-nyc.html">Arrived in NYC</a>
  </h2>

  <div>
    
    
    <p>I'm here in NYC, a city I have visited several times. This time I am here to present 2 topics on Silverlight and on ASP.NET this Monday and Tuesday. There are some great talks this week at VSLive by guys like Sahil Mallik and Brian Peek. If you have not checked out any of Peek's stuff, you really should. He is the author of the WiiMote .NET Library which has really taken off and even gotten the attention of Newsweek magazine!</p>
<p>I'll be writing in every spare moment I have while I am here. I've got some catching up to do still on the final few chapters of my book. Its a race to get it done and printed by Dec! </p>
<p>On a football note ... I've been catching up on the football action and I can't believe that Tom Brady might be out for the season! I am a Giants fan, but man, I feel for the Patriots fans. It was funny to see Strahan on Fox today being an analyst ... he's actually quite funny. Other notes ... Matt Forte, DeShawn Jackson, Matt Ryan, and Ray Rice all looked great today. What do they have in common ... they are all rookies! And in amazing style ... Michael Turner ran for 220 yards today for the Falcons. This guys was the backup to LT in San Diego for the past few years. We all knew he was good, but wow! It's going to be a fun season!</p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    September
    5th,
    
    2008
  </span>

  <h2>
    <a href="/silverlight/2008/09/05/fall-event-schedule-ndash-more-silverlight-and-data.html">Fall Event Schedule – More Silverlight and Data</a>
  </h2>

  <div>
    
    
    <p>The pieces of my Fall schedule has been falling into place recently. Here is a list of all of the events I&rsquo;ll be at for the next few months. The topics vary from Entity Framework, to MVP patterns, Enterprise Library, Database Transactions, REST, and of course Silverlight 2. If you find yourself in any of these areas, please drop by.</p>
<ul>
<li><a href="http://vslive.com/2008/newyork/default.aspx">VSLive NY</a> &ndash; NYC on Sep 7-10, 2008</li>
<li><a href="http://msevents.microsoft.com/CUI/EventDetail.aspx?EventID=1032387218&amp;culture=en-US">Day of Silverlight</a> 2 &ndash; Tampa Microsoft Office, Oct 24, 2008</li>
<li><a href="http://www.devconnections.com/">DevConnections</a> &ndash; Las Vegas, NV &ndash; Nov 10-13, 2008</li>
<li><a href="http://www.naplesdot.net/">Naples .NET User Group</a> &ndash; Naples, FL Nov 18, 2008</li>
<li><a href="http://www.cfdotnet.org/">Central Florida .NET User Group</a> &ndash; Lakeland, FL Nov 19, 2008</li>
<li><a href="http://www.onetug.org/sf/homepage.aspx">Orlando .NET User Group</a> &ndash; Orlando, FL Nov 20, 2008</li>
<li><a href="http://vslive.com/2008/dallas">VSLive Dallas</a> &ndash; Dallas, TX &ndash; Dec 8-11, 2008</li>
<li><a href="http://www.florida.net/">West Palm Beach .NET User Group</a> &ndash; West Palm Beach, FL &ndash; Jan 22, 2009</li>
</ul>
<p>Special thanks to INETA for supporting the user groups and my visits there.</p>
<p>PS &hellip;&nbsp; I just confirmed that I will be presenting in West Palm Beach on January 22nd, 2009 to their .NET user group.</p>
<div class="wlWriterHeaderFooter" style="padding-right: 4px; padding-left: 4px; padding-bottom: 4px; margin: 0px; padding-top: 4px; text-align: left"><a href="http://www.dotnetkicks.com/kick/?url=/all/fall-event-schedule-ndash-more-silverlight-and-data/"><img alt="DotNetKicks Image" border="0" src="http://www.dotnetkicks.com/Services/Images/KickItImageGenerator.ashx?url=/all/fall-event-schedule-ndash-more-silverlight-and-data/&amp;bgcolor=0080C0&amp;fgcolor=FFFFFF&amp;border=000000&amp;cbgcolor=D4E1ED&amp;cfgcolor=000000" /></a></div>
<div class="wlWriterHeaderFooter" style="padding-right: 4px; padding-left: 4px; padding-bottom: 4px; margin: 0px; padding-top: 4px; text-align: left"><script type="text/javascript"><!-- var dzone_url = '/all/fall-event-schedule-ndash-more-silverlight-and-data/'; var dzone_title = 'Fall Event Schedule – More Silverlight and Data'; var dzone_blurb = 'Fall Event Schedule – More Silverlight and Data'; var dzone_style = '2'; --></script><script language="javascript" src="http://widgets.dzone.com/widgets/zoneit.js"></script></div>


    
    
  </div>

</article>

<hr/>

<ul class="pager"> 

  
  <li class="previous">
    
    <a href="/page51">&larr; Newer</a>
    
  </li>
  
  
  <li>
    <span class="page_number">Page: 52 of 86</span>
  </li>

  
  <li class="next">
    <a href="/page53">Older &rarr;</a>
  </li>
  

</ul>





      <footer class="footer-text">
        <hr/>
        <p>
        Copyright © 2015 - John Papa Blog content licensed under the Creative Commons <a href="http://creativecommons.org/licenses/by/2.5/">CC BY 2.5</a>
        | Unless otherwise stated or granted, code samples licensed under the <a href="http://sm.mit-license.org/">MIT license</a>.
        | Site design based on the <a href="https://github.com/dbtek/dbyll">dbyll theme</a> under the <a href="http://sm.mit-license.org/">MIT license</a>
      </p>

      </footer>

    </div>

    <script type="text/javascript" src="/assets/resources/jquery/jquery.min.js"></script>
    <script type="text/javascript" src="/assets/resources/bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/assets/js/app.js"></script>

    <!--Developer Media Links-->
    <script type='text/javascript'>
        function _dmBootstrap(file) {
    var _dma = document.createElement('script'); _dma.type = 'text/javascript'; _dma.async = true; _dma.src = ('https:' == document.location.protocol ? 'https://' : 'http://')
    + file;
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(_dma);
    }
    function _dmFollowup(file) { if (typeof DMAds === 'undefined') _dmBootstrap('cdn2.DeveloperMedia.com/a.min.js');}
    (function () { _dmBootstrap('cdn1.DeveloperMedia.com/a.min.js');
    setTimeout(_dmFollowup, 2000);})();
    </script>

    <!--<script language="JavaScript" src="http://ad.doubleclick.net/N6839/adj/lqm.johnpapa.site/ron;kw=%2Cjohn%2Cpapa%2Cblog%2Cjohnpapa%7Bdot%7Dnet%2Cjohnpapa%2Cpappa%2Cwww%7Bdot%7Djohnpapa%7Bdot%7Dnet%2Cjon%2Cangular%2Cjhon;sz=160x600;dc_ref=http%3A%2F%2Fwww.johnpapa.net%2F;tile=1;ord=BEAAB484DA88D8D84B9DCB004E5712BE?"
    type="text/javascript"></script>-->

    <div data-type="ad" data-publisher="lqm.johnpapa.site" data-zone="ron" data-format="728x90" class="col-centered"></div>

</body>

</html>


<!-- Asynchronous Google Analytics snippet -->
<script>
  var _gaq = _gaq || [];
  var pluginUrl =
 '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'johnpapa']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

