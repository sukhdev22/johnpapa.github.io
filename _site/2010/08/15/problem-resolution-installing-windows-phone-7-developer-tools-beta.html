<p><a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/InstallingWindowsPhone7Beta_97C4/image_8.png"><img style="border-right-width: 0px; margin: 0px 0px 10px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" align="left" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/InstallingWindowsPhone7Beta_97C4/image_thumb_3.png" width="62" height="55" /></a>I ran into some issues installing the Windows Phone 7 developer tools beta this weekend on my PC. I had been cleaning up my hard drive of old installs so I likely had a bit of a mess. I had just installed a fresh copy of Expression Suite 4 Visual Studio 2010 Ultimate and the Silverlight 4 Tools. I tested those and everything worked great … so far so good.</p>
<p>Next step was to install the <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=c8496c2a-54d9-4b11-9491-a1bfaf32f2e3">Windows Phone 7 developer tools beta</a>. Here is where I ran into this problem … </p>
<blockquote>   <p><em>“Setup has detected that this computer does not meet the requirements to install this software. These requirements must be met before you can install Microsoft Windows Phone Developer Tools Beta - ENU” </em></p> </blockquote>
<p>The incompatible product it was referring to is “Microsoft Visual Studio 2010 Express Prerequisites x64” as shown in the window below …</p>
<p><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="clip_image002" border="0" alt="clip_image002" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/InstallingWindowsPhone7Beta_97C4/clip_image002_3.jpg" width="454" height="528" /></p>
<p>For those wanting the quick solution … it turns out that I had an old build of Visual Studio Express that I had to uninstall. But this message can appear for a variety of install blocking issues so I figured I would share what I learned about debugging the install issues. </p>
<p><strong>Note</strong>: <a href="http://blogs.msdn.com/b/astebner/archive/2010/07/12/10037442.aspx">Aaron Stebner alerted me to a blog post he had written on debugging this</a> and other messages. You can find that post here. The steps included below are my interpretation of Aaron’s steps in his “Issue #2” with specifics on my issue where applicable. </p>
<p>1) First, I opened the log file dd_install_vs_vstscore_100.txt for the install which is located in the %temp% folder. For me, this was located in this path:</p>
<blockquote>   <p><em>C:\Users\John\AppData\Local\Temp\dd_install_vs_vstscore_100.txt</em></p> </blockquote>
<p>2) I opened the file in notepad and searched for “ERRORLOG EVENT” … you might as well search for ExecuteEachBlocker though. Either way, I found the section I needed that told me where to go next. Here is the section worth noting:</p>
<blockquote>   <p>[08/13/10,23:32:15] VS Scenario: ***ERRORLOG EVENT*** : Error: CVSScenario::ExecuteEachBlocker returned false      <br />[08/13/10,23:32:15] Setup.exe: AddGlobalCustomProperty       <br />[08/13/10,23:32:15] VS Scenario: ***ERRORLOG EVENT*** : Error:There is a blocking condition met, the installer is blocking because of Section :       <br />[08/13/10,23:32:15] Setup.exe: AddGlobalCustomProperty       <br />[08/13/10,23:32:15] VS Scenario: ***ERRORLOG EVENT*** : <strong><font color="#ff0000">Microsoft Visual Studio 2010 Express Prerequisites x64</font></strong>       <br />[08/13/10,23:32:35] Setup.exe: AddGlobalCustomProperty       <br />[08/13/10,23:32:35] VS Scenario: ***ERRORLOG EVENT*** : Failed to pass the Warnings/Blocks checks in CVSScenario::Start()</p> </blockquote>
<p>3) This is the match for the message in the error window so the next step is to find the key for this entry in the setup file. This can be found by going to the setup files for the WPDT beta setup data file named blocker.sdb which is located in the vm_web.exe self extracting package. (Aaron created <a href="http://cid-27e6a35d1a492af7.office.live.com/self.aspx/Blog%5E_Tools/WPDT%5E_Beta%5E_Blocker.sdb">an extracted copy at this location</a> in case you want a quick link.)&#160; </p>
<p>4) Once you open the file search for the offending key, which in my case was “Microsoft Visual Studio 2010 Express Prerequisites x64”. This finds a section such as the one below:</p>
<blockquote>   <p>[Microsoft Visual Studio 2010 Express Prerequisites x64]      <br />VersionCheck=RegVerBuildCheck       <br /><strong><font color="#ff0000">DetectKey=HKLM,SOFTWARE\Microsoft\DevDiv\vs\Servicing\10.0\expbsln</font>         <br /></strong>DetectKeyVal=Version       <br /><strong><font color="#ff0000">DetectKeyValData=30319.01</font></strong>       <br />HelpLink=Block_on_Non_Dev10_RC_component_vm_exp.htm</p> </blockquote>
<p>5) This section identifies that if the key (DetectKey) is found and has a value (DetectKeyValData) less than the version listed, then a blocking issue will arise. This may be as far as you need to go.</p>
<p>6) If you cannot find this key it might be because the keys are slightly different for 64-bit versions of Windows. For clarity, the 32-bit key is …</p>
<blockquote>   <p>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\DevDiv\vs\Servicing\10.0\expbsln</p> </blockquote>
<p>… and 64-bit is …</p>
<blockquote>   <p>HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\DevDiv\vs\Servicing\10.0\expbsln</p> </blockquote>
<p>7) My key had a value of 30128.01, so it was easy to see it was less than the required pre-req of 30319.0 that the message indicated.</p>
<p><a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/InstallingWindowsPhone7Beta_97C4/image_4.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/InstallingWindowsPhone7Beta_97C4/image_thumb_1.png" width="370" height="181" /></a> </p>
<p>&#160;</p>
<p>Of course, when I went to the Control Panel to uninstall this blocking program it was pretty obvious in hindsight that it was the blocker. Notice the version in the image below is obviously older … reminds me of the old “which one of these is not like the other” saying :). </p>
<p><a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/InstallingWindowsPhone7Beta_97C4/image_2.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/InstallingWindowsPhone7Beta_97C4/image_thumb.png" width="579" height="66" /></a></p>
<p>So in hindsight this issue could have been resolved quicker by a little more common sense on my part, but the steps were still very valuable in understanding the issue and might come in handy in the future.</p>
<p>Special thanks to <a href="http://blogs.msdn.com/b/jaimer/">Jaime Rodriguez</a> and Aaron Stebner for their help with this.</p>

